<!DOCTYPE html>
<html>
  <head>
    <%- include(`${global.path}/components/head.ejs`, {
      head,
      global
    }) %>
  </head>
  <body class="line-numbers">
    <div class="totonoo--layout totonoo--detail">
      <%- include(`${global.path}/components/header.ejs`, {
        header,
        aside
      }) %>
      <div class="totonoo--main-box">
        <div class="totonoo--main-scroll">
          <div class="totonoo--main-layout" id="detail-layout">
            <%- include(`${global.path}/components/aside.ejs`, {
              aside
            }) %>
            <main class="main" id="detail-main">
              <div class="detail-main">
                <%
                const navigation = main.content.navigation || []
                %>
                <article class="detail-article" id="detail-article">
                  <%
                  const content = main.content
                  %>
                  <div class="totonoo--article-title">
                    <h1 class="page-title"><%= content.title %></h1>
                    <div class="info">
                      <ul>
                        <li><i class="iconfont icon-time"></i><%= global.formatDatetime(content.publishDate) %></li>
                        <li><i class="iconfont icon-folder-close"></i><a href="<%= global.mkArticleLink(content.filepath, 'index') %>"><%= content.catalogueName %></a></li>
                        <li>
                          <i class="iconfont icon-discount"></i>
                          <%
                          const _keywords = content.keywords || []
                          _keywords.forEach(keyword => {
                          %>
                          <a href="<%= global.mkTagsLink(keyword) %>"><%= keyword %></a>
                          <% }) %> 
                        </li>
                      </ul>
                    </div>
                  </div>
                  <div class="totonoo--markdown-style" id="totonoo--article">
                    <%- content.body %>
                  </div>
                  <div class="totonoo--article-related">
                    <ul>
                      <%
                      const prev = main.related.prev
                      const next = main.related.next
                      %>
                      <li>
                        <a href="<%= global.mkArticleLink(prev.filepath, prev.filename) %>"><i class="iconfont icon-direction-left"></i> <%= prev.title %></a>
                      </li>
                      <li>
                        <a href="<%= global.mkArticleLink(next.filepath, next.filename) %>"><%= next.title %> <i class="iconfont icon-direction-right"></i></a>
                      </li>
                    </ul>
                  </div>
                </article>
                <% if (navigation.length > 0 ) { %>
                  <div class="article-nav" id="article-nav">
                  <ul>
                    <%
                    navigation.forEach((item, index) => {
                    %>
                    <li class="<%= item.tag %><%= index == 0 ? ' current' : '' %>" data-index="<%= index%>"><a href="#<%= item.slug %>"><%= item.title %></a></li>
                    <%
                    })
                    %>
                  </ul>
                </div>
                <% } %>
              </div>
            </main>
          </div>
          <%- include(`${global.path}/components/footer.ejs`, {
            global,
            footer
          }) %>
        </div>
      </div>
    </div>
    <%- include(`${global.path}/components/scripts.ejs`, {
      global,
      scripts
    }) %>
  </body>
</html>
